import{a as w}from"./chunk-BCRYDC5W.js";import{A,B as O,M as mt,N as lt,P as ut,Q as st,R as pt,S as dt,T as ft,U as gt,V as ht,W as bt,X as Ct,Y as xt,Z as _t,a as K,ba as P,ca as vt,h as W,i as S,j as k,k as X,l as y,m as Y,n as Z,o as E,p as tt,q as N,r as et,s as nt,u as ot,v as it,w as rt,x as at,z as ct}from"./chunk-WRA2O52K.js";import{$b as G,Ab as d,Bb as b,Cb as C,Eb as V,Hb as v,Jc as U,Mc as z,Nb as B,Nc as J,Ob as L,Pb as q,Rb as a,Sb as M,Wa as m,Xa as f,_b as $,aa as F,ac as Q,ba as x,fa as T,ga as R,la as s,ma as _,mb as u,ob as l,ta as j,ua as H,yb as i,zb as o}from"./chunk-HZRNHZZ5.js";var I=(()=>{let t=class t{constructor(r){this.http=r,this.baseUrl=X.apiUrl}registerAccount(r){let n=`${this.baseUrl}/accounts`;return this.http.post(n,r)}getAllAccounts(r){let n=`${this.baseUrl}/accounts/customers/${r}`;return this.http.get(n)}};t.\u0275fac=function(n){return new(n||t)(T(K))},t.\u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var Tt=()=>[5,10,20];function jt(e,t){e&1&&(i(0,"th",20),a(1,"Id"),o())}function Ht(e,t){if(e&1&&(i(0,"td",21),a(1),o()),e&2){let h=t.$implicit;m(),M(h.id)}}function Vt(e,t){e&1&&(i(0,"th",20),a(1,"N\xFAmero de cuenta"),o())}function Bt(e,t){if(e&1&&(i(0,"td",21),a(1),o()),e&2){let h=t.$implicit;m(),M(h.accountNumber)}}function Lt(e,t){e&1&&(i(0,"th",20),a(1,"Saldo"),o())}function qt(e,t){if(e&1&&(i(0,"td",21),a(1),G(2,"currency"),o()),e&2){let h=t.$implicit;m(),M(Q(2,1,h.balance))}}function $t(e,t){e&1&&(i(0,"th",20),a(1,"Acciones"),o())}function Gt(e,t){e&1&&(i(0,"td",21)(1,"button",22),a(2,"Editar"),o(),i(3,"button",23),a(4,"Eliminar"),o()())}function Qt(e,t){e&1&&d(0,"tr",24)}function Ut(e,t){e&1&&d(0,"tr",25)}var Mt=(()=>{let t=class t{constructor(){this.displayedColumns=["id","numero","saldo","acciones"],this.dataSource=new _t,this.accountService=R(I),this.authService=R(w),this.loginResponse=this.authService.getLoginResponse()}ngAfterViewInit(){this.dataSource.paginator=this.paginator}ngOnInit(){this.loginResponse&&this.loadAccounts(this.loginResponse.user.id)}loadAccounts(r){this.accountService.getAllAccounts(r).subscribe({next:n=>{this.dataSource.data=n,console.log("Cuentas del cliente:",n)},error:n=>{console.error("Error al cargar cuentas del cliente:",n)}})}applyFilter(r){let n=r.target.value;this.dataSource.filter=n.trim().toLowerCase()}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=s({type:t,selectors:[["app-account"]],viewQuery:function(n,c){if(n&1&&B(P,5),n&2){let p;L(p=q())&&(c.paginator=p.first)}},decls:32,vars:5,consts:[["input",""],[1,"container","py-5"],[1,"fw-bold","text-center"],[1,"header-controls"],["appearance","fill",1,"filter"],["matInput","","placeholder","Ex. ium",3,"keyup"],["mat-button","","matSuffix",""],[1,"button-container"],["mat-raised-button","","color","primary","routerLink","/account/register"],[1,"table-container"],["mat-table","",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","numero"],["matColumnDef","saldo"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",3,"pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],["mat-button","",1,"edit-button"],["mat-button","",1,"delete-button"],["mat-header-row",""],["mat-row",""]],template:function(n,c){if(n&1){let p=V();i(0,"div",1)(1,"h1",2),a(2,"Listado de Cuenta Bancarias"),o(),i(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),a(6,"Filter"),o(),i(7,"input",5,0),v("keyup",function(Pt){return j(p),H(c.applyFilter(Pt))}),o(),i(9,"button",6)(10,"mat-icon"),a(11,"search"),o()()(),i(12,"div",7)(13,"button",8),a(14," Crear cuenta bancaria "),o()()(),i(15,"div",9)(16,"table",10),b(17,11),u(18,jt,2,0,"th",12)(19,Ht,2,1,"td",13),C(),b(20,14),u(21,Vt,2,0,"th",12)(22,Bt,2,1,"td",13),C(),b(23,15),u(24,Lt,2,0,"th",12)(25,qt,3,3,"td",13),C(),b(26,16),u(27,$t,2,0,"th",12)(28,Gt,5,0,"td",13),C(),u(29,Qt,1,0,"tr",17)(30,Ut,1,0,"tr",18),o(),d(31,"mat-paginator",19),o()()}n&2&&(m(16),l("dataSource",c.dataSource),m(13),l("matHeaderRowDef",c.displayedColumns),m(),l("matRowDefColumns",c.displayedColumns),m(),l("pageSizeOptions",$(4,Tt)))},dependencies:[S,E,A,y,Z,O,lt,ut,pt,ht,dt,st,bt,ft,gt,Ct,xt,P,z],styles:[".container[_ngcontent-%COMP%]{max-width:1000px;margin:20px auto 0}h1[_ngcontent-%COMP%]{color:#333;text-align:center;margin-bottom:24px}.header-controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.filter[_ngcontent-%COMP%]{flex:1;max-width:400px}.filter[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.button-container[_ngcontent-%COMP%]{margin-left:20px}.table-container[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;box-shadow:0 4px 8px #0000001a;background-color:#fff;border-radius:8px;overflow:hidden}mat-header-cell[_ngcontent-%COMP%], mat-cell[_ngcontent-%COMP%]{padding:16px;text-align:left}mat-header-cell[_ngcontent-%COMP%]{background-color:#009739;color:#fff;font-weight:700}mat-row[_ngcontent-%COMP%]:nth-child(2n){background-color:#f3f3f3}mat-row[_ngcontent-%COMP%]:nth-child(odd){background-color:#fff}mat-cell[_ngcontent-%COMP%]{border-bottom:1px solid #e0e0e0}button[mat-button][_ngcontent-%COMP%]{margin:0 8px;color:#fff}button[mat-button].edit-button[_ngcontent-%COMP%]{background-color:#4caf50}button[mat-button].delete-button[_ngcontent-%COMP%]{background-color:#f44336}"]});let e=t;return e})();var St=e=>{let t=e.value;return/^\d{10}$/.test(t)?null:{invalidAccountNumber:!0}},wt=e=>{let t=parseFloat(e.value);return isNaN(t)||t<=0?{invalidAmount:!0}:null};function zt(e,t){e&1&&(i(0,"mat-error"),a(1," Este campo es obligatorio "),o())}function Jt(e,t){e&1&&(i(0,"mat-error"),a(1," El numero de cuenta debe tener 10 digitos "),o())}function Kt(e,t){e&1&&(i(0,"mat-error"),a(1," Este campo es obligatorio "),o())}function Wt(e,t){e&1&&(i(0,"mat-error"),a(1," El monto no puede ser negativo o igual a cero "),o())}var yt=(()=>{let t=class t{constructor(r,n,c,p,D){this.fb=r,this.router=n,this.accountService=c,this.authService=p,this.snackBar=D,this.form=this.fb.group({accountNumber:["",[N.required,St]],balance:["",[N.required,wt]]}),this.loginResponse=this.authService.getLoginResponse()}ngOnInit(){}controlHasError(r,n){return this.form.controls[r].hasError(n)}onSubmit(){if(this.form.invalid||!this.loginResponse)return;let r=this.form.value,n={id:0,accountNumber:r.accountNumber,balance:r.balance,customerId:this.loginResponse.user.id};this.accountService.registerAccount(n).subscribe({next:c=>{this.router.navigate(["/account"]),this.showSnackBar("Cuenta registrada exitosamente")},error:c=>{console.error("Error al registrar cuenta:",c),this.showSnackBar("Error al registrar cuenta. Por favor, intenta de nuevo.")}})}showSnackBar(r){this.snackBar.open(r,"Cerrar",{duration:3e3})}};t.\u0275fac=function(n){return new(n||t)(f(at),f(W),f(I),f(w),f(mt))},t.\u0275cmp=s({type:t,selectors:[["app-register-account"]],decls:23,vars:6,consts:[[1,"container","py-5"],[1,"fw-bold","text-center"],[1,"row","justify-content-center","my-5"],[1,"col-md-6","col-lg-4"],["autocomplete","off",1,"mt-5",3,"ngSubmit","formGroup"],["appearance","outline",1,"mb-2","w-100"],["matInput","","formControlName","accountNumber","placeholder","Ingrese el n\xFAmero de cuenta"],[4,"ngIf"],["matInput","","formControlName","balance","placeholder","Ingrese el saldo"],[1,"button-container"],["mat-raised-button","","color","accent","type","button","routerLink","/account"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(n,c){n&1&&(i(0,"div",0)(1,"h1",1),a(2,"Registro de Cuenta Bancaria"),o(),i(3,"div",2)(4,"div",3)(5,"form",4),v("ngSubmit",function(){return c.onSubmit()}),i(6,"mat-form-field",5)(7,"mat-label"),a(8,"N\xFAmero de Cuenta"),o(),d(9,"input",6),u(10,zt,2,0,"mat-error",7)(11,Jt,2,0,"mat-error",7),o(),i(12,"mat-form-field",5)(13,"mat-label"),a(14,"Saldo"),o(),d(15,"input",8),u(16,Kt,2,0,"mat-error",7)(17,Wt,2,0,"mat-error",7),o(),i(18,"div",9)(19,"button",10),a(20," Cancelar "),o(),i(21,"button",11),a(22," Registrar "),o()()()()()()),n&2&&(m(5),l("formGroup",c.form),m(5),l("ngIf",c.controlHasError("accountNumber","required")),m(),l("ngIf",c.controlHasError("accountNumber","invalidAccountNumber")&&!c.controlHasError("accountNumber","required")),m(5),l("ngIf",c.controlHasError("balance","required")),m(),l("ngIf",c.controlHasError("balance","invalidAmount")&&!c.controlHasError("balance","required")),m(4),l("disabled",!c.form.valid))},dependencies:[U,S,ot,tt,et,nt,it,rt,E,A,y,Y,O],styles:["table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;box-shadow:0 4px 8px #0000001a;background-color:#fff;border-radius:8px;overflow:hidden}.button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:150px;margin-right:16px}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:16px}.container[_ngcontent-%COMP%]{max-width:1000px;margin:20px auto 0}.text-start[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;margin-bottom:16px;width:100%;max-width:400px}.text-start[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.table-container[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;box-shadow:0 4px 8px #0000001a;background-color:#fff;border-radius:8px;overflow:hidden;margin-top:20px}mat-header-cell[_ngcontent-%COMP%], mat-cell[_ngcontent-%COMP%]{padding:16px;text-align:left}mat-header-cell[_ngcontent-%COMP%]{background-color:#009739;color:#fff;font-weight:700}mat-row[_ngcontent-%COMP%]:nth-child(2n){background-color:#f3f3f3}mat-row[_ngcontent-%COMP%]:nth-child(odd){background-color:#fff}mat-cell[_ngcontent-%COMP%]{border-bottom:1px solid #e0e0e0}button[mat-button][_ngcontent-%COMP%]{margin:0 8px;color:#fff}button[mat-button].edit-button[_ngcontent-%COMP%]{background-color:#4caf50}button[mat-button].delete-button[_ngcontent-%COMP%]{background-color:#f44336}h1[_ngcontent-%COMP%]{color:#333;text-align:center;margin-bottom:24px}"]});let e=t;return e})();var Et=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=s({type:t,selectors:[["app-edit-account"]],decls:2,vars:0,template:function(n,c){n&1&&(i(0,"p"),a(1,"edit-account works!"),o())}});let e=t;return e})();var At=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=s({type:t,selectors:[["app-filter-account"]],decls:2,vars:0,template:function(n,c){n&1&&(i(0,"p"),a(1,"filter-account works!"),o())}});let e=t;return e})();var Xt=[{path:"",component:Mt},{path:"register",component:yt},{path:"edit",component:Et},{path:"filter",component:At}],Ot=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=_({type:t}),t.\u0275inj=x({imports:[k.forChild(Xt),k]});let e=t;return e})();var He=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=_({type:t}),t.\u0275inj=x({imports:[J,Ot,ct,vt]});let e=t;return e})();export{He as AccountModule};
